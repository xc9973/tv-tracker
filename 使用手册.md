# TV Tracker ä½¿ç”¨æ‰‹å†Œ

## ğŸ“– é¡¹ç›®ç®€ä»‹

TV Tracker æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç”µè§†å‰§è¿½è¸ªç®¡ç†ç³»ç»Ÿï¼Œå¸®åŠ©æ‚¨è®¢é˜…ã€è¿½è¸ªå’Œç®¡ç†ç¾å‰§æ›´æ–°ã€‚ç³»ç»Ÿæ”¯æŒ Telegram Bot å’Œ Web ç•Œé¢ä¸¤ç§äº¤äº’æ–¹å¼ï¼Œè®©æ‚¨éšæ—¶éšåœ°æŒæ¡å‰§é›†æ›´æ–°åŠ¨æ€ã€‚

### æ ¸å¿ƒåŠŸèƒ½

- âœ… **æ™ºèƒ½è®¢é˜…ç®¡ç†** - åŸºäº TMDB æ•°æ®åº“è®¢é˜…å–œçˆ±çš„å‰§é›†
- âœ… **è‡ªåŠ¨åŒæ­¥æ›´æ–°** - è‡ªåŠ¨åŒæ­¥æœ€æ–°å‰§é›†ä¿¡æ¯å¹¶ç”Ÿæˆè§‚çœ‹ä»»åŠ¡
- âœ… **ä»Šæ—¥æ›´æ–°æé†’** - æ¯å¤©å®šæ—¶æ¨é€å½“æ—¥æ›´æ–°çš„å‰§é›†
- âœ… **ä»»åŠ¡çœ‹æ¿** - åˆ†ç±»ç®¡ç†è§‚çœ‹ä»»åŠ¡ï¼ˆä»Šæ—¥/å»¶æœŸ/æœªæ¥ï¼‰
- âœ… **èµ„æºæ—¶é—´è®¾ç½®** - ä¸ºæ¯ä¸ªå‰§é›†è®¾ç½®èµ„æºæ›´æ–°æ—¶é—´æé†’
- âœ… **Telegram Bot** - é€šè¿‡ Telegram å¿«é€Ÿç®¡ç†è®¢é˜…å’Œä»»åŠ¡
- âœ… **Web ç•Œé¢** - ç›´è§‚çš„ç½‘é¡µç®¡ç†ç•Œé¢
- âœ… **æ•°æ®å¤‡ä»½** - è‡ªåŠ¨å¤‡ä»½æ•°æ®åº“ï¼Œç¡®ä¿æ•°æ®å®‰å…¨

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šDocker éƒ¨ç½²ï¼ˆæ¨èï¼‰

#### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿æ‚¨çš„ç³»ç»Ÿå·²å®‰è£…ï¼š
- Docker 20.10+
- Docker Compose 2.0+

#### 2. è·å–å¿…è¦çš„ API å¯†é’¥

**TMDB API Key**
1. è®¿é—® [The Movie Database](https://www.themoviedb.org/)
2. æ³¨å†Œ/ç™»å½•è´¦å·
3. å‰å¾€ [API è®¾ç½®é¡µé¢](https://www.themoviedb.org/settings/api)
4. ç”³è¯· API Keyï¼ˆé€‰æ‹© Developer ç±»å‹ï¼‰
5. å¤åˆ¶ç”Ÿæˆçš„ API Key

**Telegram Bot Token**
1. åœ¨ Telegram ä¸­æœç´¢ `@BotFather`
2. å‘é€ `/newbot` å‘½ä»¤åˆ›å»ºæ–° Bot
3. æŒ‰æç¤ºè®¾ç½® Bot åç§°å’Œç”¨æˆ·å
4. ä¿å­˜ç”Ÿæˆçš„ Tokenï¼ˆæ ¼å¼ï¼š`123456789:ABCdefGHIjklMNOpqrsTUVwxyz`ï¼‰

**Telegram Chat ID**
1. åœ¨ Telegram ä¸­æœç´¢ `@userinfobot`
2. å‘é€ä»»æ„æ¶ˆæ¯
3. è®°å½•è¿”å›çš„ `Id` æ•°å€¼ï¼ˆè¿™æ˜¯æ‚¨çš„ä¸ªäºº Chat IDï¼‰

#### 3. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶
vim .env
```

åœ¨ `.env` æ–‡ä»¶ä¸­å¡«å…¥ä»¥ä¸‹ä¿¡æ¯ï¼š

```bash
# TMDB API Keyï¼ˆå¿…å¡«ï¼‰
TMDB_API_KEY=ä½ çš„TMDB_API_KEY

# Telegram Bot é…ç½®ï¼ˆå¿…å¡«ï¼‰
TELEGRAM_BOT_TOKEN=ä½ çš„BOT_TOKEN
TELEGRAM_CHAT_ID=ä½ çš„CHAT_ID

# é¢‘é“ IDï¼ˆå¯é€‰ï¼Œç”¨äºå‘é€æ¯æ—¥æ—¥æŠ¥åˆ°é¢‘é“ï¼‰
# å¦‚æœä¸é…ç½®ï¼Œæ—¥æŠ¥ä¼šå‘é€åˆ°ç®¡ç†å‘˜ç§èŠ
TELEGRAM_CHANNEL_ID=-1001234567890

# æ—¥æŠ¥å‘é€æ—¶é—´ï¼ˆå¯é€‰ï¼Œé»˜è®¤ 08:00ï¼‰
REPORT_TIME=09:00

# Web ç•Œé¢é…ç½®ï¼ˆæ¨èå¯ç”¨ï¼‰
WEB_ENABLED=true
WEB_LISTEN_ADDR=:18080

# Web è®¿é—®å¯†ç ï¼ˆé‡è¦ï¼è¯·è®¾ç½®å¼ºå¯†ç ï¼‰
WEB_API_TOKEN=ä½ çš„å¼ºå¯†ç 
```

#### 4. å¯åŠ¨æœåŠ¡

```bash
# åˆ›å»ºæ•°æ®ç›®å½•
mkdir -p data/backups

# æ„å»ºå¹¶å¯åŠ¨æœåŠ¡
docker compose build
docker compose up -d
```

#### 5. è®¿é—®åº”ç”¨

- **Web ç•Œé¢**ï¼š`http://ä½ çš„æœåŠ¡å™¨IP`
- **å¥åº·æ£€æŸ¥**ï¼š`http://ä½ çš„æœåŠ¡å™¨IP/api/health`

---

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘è¿è¡Œ

#### åç«¯æœåŠ¡

```bash
# 1. å®‰è£… Go 1.23+
# macOS
brew install go

# 2. é…ç½®ç¯å¢ƒå˜é‡
export TMDB_API_KEY=ä½ çš„TMDB_API_KEY
export TELEGRAM_BOT_TOKEN=ä½ çš„BOT_TOKEN
export TELEGRAM_CHAT_ID=ä½ çš„CHAT_ID
export WEB_ENABLED=true
WEB_API_TOKEN=ä½ çš„å¼ºå¯†ç 

# 3. å¯åŠ¨åç«¯
go run ./cmd/server
```

#### å‰ç«¯ç•Œé¢ï¼ˆå¯é€‰ï¼‰

```bash
# 1. è¿›å…¥å‰ç«¯ç›®å½•
cd web

# 2. å®‰è£…ä¾èµ–
npm install

# 3. é…ç½®ç¯å¢ƒå˜é‡
echo "VITE_API_TOKEN=ä½ çš„å¼ºå¯†ç " > .env

# 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

æµè§ˆå™¨è®¿é—® Vite æ˜¾ç¤ºçš„åœ°å€ï¼ˆé€šå¸¸æ˜¯ `http://localhost:5173`ï¼‰

---

## ğŸ“± Telegram Bot ä½¿ç”¨æŒ‡å—

### åŸºç¡€å‘½ä»¤

åœ¨ Telegram ä¸­æ‰¾åˆ°æ‚¨çš„ Botï¼Œå‘é€ä»¥ä¸‹å‘½ä»¤ï¼š

#### `/start` - å¯åŠ¨ Bot
æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯å’Œä¸»èœå•æŒ‰é’®ã€‚

#### `/today` - ä»Šæ—¥æ›´æ–°
æŸ¥çœ‹ä»Šå¤©æ’­å‡ºçš„å‰§é›†åˆ—è¡¨ï¼ŒåŒ…æ‹¬ï¼š
- å‰§é›†åç§°
- å­£æ•°å’Œé›†æ•°
- é›†æ•°æ ‡é¢˜
- é¢„è®¡èµ„æºæ›´æ–°æ—¶é—´

#### `/tasks` - å¾…åŠä»»åŠ¡
æŸ¥çœ‹æ‰€æœ‰å¾…å®Œæˆçš„è§‚çœ‹ä»»åŠ¡ï¼Œåˆ†ç±»ä¸ºï¼š
- **æ›´æ–°ä»»åŠ¡** - æ–°å‰§é›†éœ€è¦ä¸‹è½½/è§‚çœ‹
- **æ•´ç†ä»»åŠ¡** - å‰§é›†å·²å®Œç»“ï¼Œéœ€è¦æ•´ç†å½’æ¡£

#### `/sync` - åŒæ­¥æ›´æ–°
æ‰‹åŠ¨è§¦å‘æ‰€æœ‰è®¢é˜…å‰§é›†çš„åŒæ­¥ï¼Œä» TMDB è·å–æœ€æ–°ä¿¡æ¯ã€‚

#### `/backup` - æ•°æ®å¤‡ä»½
ç«‹å³åˆ›å»ºæ•°æ®åº“å¤‡ä»½æ–‡ä»¶ã€‚

### äº¤äº’æŒ‰é’®

Bot ä¼šæ ¹æ®ä¸Šä¸‹æ–‡æ˜¾ç¤ºå†…è”æŒ‰é’®ï¼Œç‚¹å‡»å³å¯æ‰§è¡Œæ“ä½œï¼š

**ä»»åŠ¡æ“ä½œ**
- âœ… **å®Œæˆ** - æ ‡è®°ä»»åŠ¡ä¸ºå·²å®Œæˆ
- â° **å»¶æœŸ** - å°†ä»»åŠ¡å»¶æœŸåˆ°æ˜å¤©

**å¿«æ·æ“ä½œ**
- ğŸ”„ **åŒæ­¥æ‰€æœ‰** - åŒæ­¥æ‰€æœ‰å‰§é›†
- ğŸ—‚ï¸ **æ•´ç†ä»»åŠ¡** - æ¸…ç†å·²æ’­å®Œå‰§é›†
- ğŸ“Š **æŸ¥çœ‹ç»Ÿè®¡** - æŸ¥çœ‹è®¢é˜…ç»Ÿè®¡

### æ¯æ—¥æ¨é€

ç³»ç»Ÿä¼šåœ¨æ¯å¤©è®¾å®šçš„æ—¶é—´ï¼ˆé»˜è®¤ 08:00ï¼‰è‡ªåŠ¨å‘é€æ—¥æŠ¥ï¼ŒåŒ…å«ï¼š

```
ğŸ“º ä»Šæ—¥æ›´æ–°æŠ¥å‘Š - 2024-01-09

ğŸ¬ é¾™ä¹‹å®¶æ— ç¬¬äºŒå­£ ç¬¬5é›†
   èµ„æºæ—¶é—´ï¼šå‘¨å››å‡Œæ™¨3ç‚¹

ğŸ¬ æŒ‡ç¯ç‹ï¼šåŠ›é‡ä¹‹ç¯ ç¬¬äºŒå­£ ç¬¬3é›†
   èµ„æºæ—¶é—´ï¼šå‘¨å››å‡Œæ™¨4ç‚¹

å…± 2 éƒ¨å‰§é›†ä»Šæ—¥æ›´æ–°
```

---

## ğŸŒ Web ç•Œé¢ä½¿ç”¨æŒ‡å—

### é¦–æ¬¡è®¿é—®

1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://ä½ çš„æœåŠ¡å™¨IP`
2. ç³»ç»Ÿä¼šè¦æ±‚è¾“å…¥è®¿é—®å¯†ç 
3. è¾“å…¥æ‚¨åœ¨ `WEB_API_TOKEN` ä¸­è®¾ç½®çš„å¯†ç 
4. ç™»å½•æˆåŠŸåä¼šè‡ªåŠ¨ä¿å­˜å‡­è¯ï¼Œæ— éœ€é‡å¤è¾“å…¥

### åŠŸèƒ½é¡µé¢

#### ğŸ“Š ä»ªè¡¨ç›˜ï¼ˆDashboardï¼‰

è®¿é—®è·¯å¾„ï¼š`/` æˆ– `/dashboard`

å±•ç¤ºæ‰€æœ‰è§‚çœ‹ä»»åŠ¡ï¼Œåˆ†ä¸ºä¸‰ä¸ªåŒºåŸŸï¼š

**ä»Šæ—¥ä»»åŠ¡**
- è®¡åˆ’æ—¥æœŸä¸ºä»Šå¤©çš„ä»»åŠ¡
- æ˜¾ç¤ºå‰§é›†åç§°ã€ä»»åŠ¡æè¿°ã€èµ„æºæ—¶é—´
- å¯æ‰§è¡Œæ“ä½œï¼š
  - âœ… å®Œæˆä»»åŠ¡
  - â° å»¶æœŸåˆ°æ˜å¤©

**å»¶æœŸä»»åŠ¡**
- ä¹‹å‰å»¶æœŸæœªå®Œæˆçš„ä»»åŠ¡
- æŒ‰å»¶æœŸæ—¶é—´æ’åº
- åŒæ ·æ”¯æŒå®Œæˆå’Œå»¶æœŸæ“ä½œ

**æœªæ¥ä»»åŠ¡**
- è®¡åˆ’æ—¥æœŸåœ¨æœªæ¥çš„ä»»åŠ¡
- æŒ‰æ—¥æœŸå‡åºæ’åˆ—

#### ğŸ“… ä»Šæ—¥æ›´æ–°ï¼ˆTodayï¼‰

è®¿é—®è·¯å¾„ï¼š`/today`

å±•ç¤ºä»Šå¤©æ’­å‡ºçš„æ‰€æœ‰å‰§é›†ï¼š

- å‰§é›†åç§°å’Œæµ·æŠ¥
- å­£æ•°å’Œé›†æ•°ä¿¡æ¯
- é›†æ•°æ ‡é¢˜å’Œç®€ä»‹
- é¢„è®¡èµ„æºæ›´æ–°æ—¶é—´

#### ğŸ“š ç‰‡åº“ï¼ˆLibraryï¼‰

è®¿é—®è·¯å¾„ï¼š`/library`

ç®¡ç†æ‰€æœ‰è®¢é˜…çš„å‰§é›†ï¼š

**åŠŸèƒ½æ“ä½œ**
- ğŸ—‘ï¸ å–æ¶ˆè®¢é˜…ï¼ˆè½¯åˆ é™¤ï¼Œæ•°æ®ä¿ç•™ï¼‰
- â° è®¾ç½®èµ„æºæ—¶é—´
  - ç‚¹å‡»æ—¶é—´è¾“å…¥æ¡†
  - è¾“å…¥èµ„æºæ›´æ–°æ—¶é—´ï¼Œå¦‚"å‘¨å››å‡Œæ™¨3ç‚¹"
  - ç‚¹å‡»ä¿å­˜

**å‰§é›†ä¿¡æ¯**
- å‰§é›†åç§°
- æ€»å­£æ•°
- æ’­å‡ºçŠ¶æ€ï¼ˆæ­£åœ¨æ’­å‡º/å·²å®Œç»“ï¼‰
- åŸäº§å›½å®¶
- èµ„æºæ—¶é—´
- è®¢é˜…æ—¶é—´

#### ğŸ” æœç´¢è®¢é˜…ï¼ˆSearchï¼‰

è®¿é—®è·¯å¾„ï¼š`/search`

æœç´¢å¹¶è®¢é˜…æ–°å‰§é›†ï¼š

1. åœ¨æœç´¢æ¡†è¾“å…¥å‰§é›†åç§°ï¼ˆè‹±æ–‡æˆ–ä¸­æ–‡ï¼‰
2. ç³»ç»Ÿä¼šå®æ—¶æœç´¢ TMDB æ•°æ®åº“
3. æ˜¾ç¤ºæœç´¢ç»“æœï¼š
   - å‰§é›†æµ·æŠ¥
   - å‰§é›†åç§°
   - é¦–æ’­æ—¥æœŸ
   - åŸäº§å›½å®¶
4. ç‚¹å‡»"è®¢é˜…"æŒ‰é’®å³å¯å®Œæˆè®¢é˜…

**æœç´¢æç¤º**
- æ”¯æŒè‹±æ–‡å’Œä¸­æ–‡æœç´¢
- å»ºè®®ä½¿ç”¨è‹±æ–‡åŸåæœç´¢ï¼Œç»“æœæ›´å‡†ç¡®
- å¯ä»¥è¾“å…¥éƒ¨åˆ†åç§°è¿›è¡Œæ¨¡ç³Šæœç´¢

---

## ğŸ”§ é«˜çº§é…ç½®

### ç¯å¢ƒå˜é‡å®Œæ•´è¯´æ˜

| å˜é‡å | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|------|--------|------|
| `TMDB_API_KEY` | âœ… | - | TMDB API å¯†é’¥ï¼Œä» themoviedb.org è·å– |
| `TELEGRAM_BOT_TOKEN` | âœ… | - | Telegram Bot Tokenï¼Œä» @BotFather è·å– |
| `TELEGRAM_CHAT_ID` | âœ… | - | ç®¡ç†å‘˜ Chat IDï¼Œä» @userinfobot è·å– |
| `TELEGRAM_CHANNEL_ID` | âŒ | - | æ¨é€é¢‘é“ IDï¼Œæœªé…ç½®åˆ™å‘é€åˆ°ç®¡ç†å‘˜ç§èŠ |
| `REPORT_TIME` | âŒ | `08:00` | æ¯æ—¥æŠ¥å‘Šæ—¶é—´ï¼Œæ ¼å¼ HH:MM |
| `WEB_ENABLED` | âŒ | `false` | æ˜¯å¦å¯ç”¨ Web æœåŠ¡ |
| `WEB_LISTEN_ADDR` | âŒ | `:18080` | Web ç›‘å¬åœ°å€ |
| `WEB_API_TOKEN` | Web å¿…å¡« | - | API é‰´æƒ Tokenï¼Œç”¨äº Web è®¿é—® |
| `DB_PATH` | âŒ | `./data/tv_tracker.db` | SQLite æ•°æ®åº“è·¯å¾„ |
| `BACKUP_DIR` | âŒ | `./data/backups` | å¤‡ä»½ç›®å½• |
| `DISABLE_BOT` | âŒ | `false` | ç¦ç”¨ Telegram Bot |
| `SHUTDOWN_TIMEOUT` | âŒ | `5` | å…³é—­è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |
| `STATIC_DIR` | âŒ | `./web/simple` | é™æ€æ–‡ä»¶ç›®å½• |

### ç«¯å£é…ç½®

**ä¿®æ”¹å¯¹å¤–è®¿é—®ç«¯å£**

ç¼–è¾‘ `docker-compose.yml`ï¼š

```yaml
services:
  tv-tracker-web:
    ports:
      - "8080:80"  # å°† 80 æ”¹ä¸º 8080
```

**ä¿®æ”¹åç«¯å†…éƒ¨ç«¯å£**

éœ€è¦åŒæ—¶ä¿®æ”¹ï¼š
1. `docker-compose.yml` ä¸­çš„ `WEB_LISTEN_ADDR`
2. Nginx é…ç½®æ–‡ä»¶ä¸­çš„ä»£ç†åœ°å€

### æ•°æ®å¤‡ä»½ä¸æ¢å¤

**è‡ªåŠ¨å¤‡ä»½**
- ç³»ç»Ÿæ¯å‘¨æ—¥å‡Œæ™¨ 3:00 è‡ªåŠ¨å¤‡ä»½
- å¤‡ä»½æ–‡ä»¶ä¿å­˜åœ¨ `data/backups/` ç›®å½•
- æ–‡ä»¶åæ ¼å¼ï¼š`tv_tracker_YYYYMMDD_HHMMSS.db`

**æ‰‹åŠ¨å¤‡ä»½**
```bash
# æ–¹æ³•1ï¼šé€šè¿‡ API
curl -X POST -H "Authorization: Bearer $WEB_API_TOKEN" \
  http://localhost/api/backup

# æ–¹æ³•2ï¼šé€šè¿‡ Telegram Bot
å‘é€ /backup å‘½ä»¤
```

**æ•°æ®æ¢å¤**
```bash
# 1. åœæ­¢æœåŠ¡
docker compose down

# 2. æ¢å¤æ•°æ®åº“
cp data/backups/tv_tracker_20240109_030000.db data/tv_tracker.db

# 3. é‡å¯æœåŠ¡
docker compose up -d
```

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1ï¼šå‰ç«¯æ˜¾ç¤º "æœªæˆæƒï¼Œè¯·æ£€æŸ¥è®¿é—®ä»¤ç‰Œ"

**åŸå› **ï¼š`WEB_API_TOKEN` ä¸å‰ç«¯é…ç½®ä¸ä¸€è‡´

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ£€æŸ¥ .env æ–‡ä»¶ä¸­çš„ WEB_API_TOKEN
cat .env | grep WEB_API_TOKEN

# 2. å‰ç«¯å¼€å‘ç¯å¢ƒéœ€è¦è®¾ç½® .env
cd web
echo "VITE_API_TOKEN=ä½ çš„å¯†ç " > .env

# 3. é‡æ–°æ„å»ºå‰ç«¯ï¼ˆDocker éƒ¨ç½²ï¼‰
docker compose restart tv-tracker-web

# 4. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å¹¶åˆ·æ–°
```

### é—®é¢˜2ï¼šTelegram Bot æ— å“åº”

**åŸå› **ï¼šBot Token æˆ– Chat ID é…ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. éªŒè¯ Bot Token
curl "https://api.telegram.org/botä½ çš„BOT_TOKEN/getMe"

# 2. éªŒè¯ Chat ID
# åœ¨ Telegram ä¸­å‘ @userinfobot å‘é€æ¶ˆæ¯è·å–æ­£ç¡®çš„ Chat ID

# 3. æ£€æŸ¥ç½‘ç»œè¿æ¥
curl -I https://api.telegram.org

# 4. æŸ¥çœ‹åç«¯æ—¥å¿—
docker compose logs -f tv-tracker-api
```

### é—®é¢˜3ï¼šTMDB API è¯·æ±‚å¤±è´¥

**åŸå› **ï¼šAPI Key æ— æ•ˆæˆ–è¾¾åˆ°é™æµ

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. éªŒè¯ API Key
curl "https://api.themoviedb.org/3/movie/550?api_key=ä½ çš„API_KEY"

# 2. æ£€æŸ¥ API Key ç±»å‹
# ç¡®ä¿ä½¿ç”¨çš„æ˜¯ v3 API Keyï¼ˆ32ä½åå…­è¿›åˆ¶ï¼‰
# è€Œä¸æ˜¯ v4 Access Tokenï¼ˆJWT æ ¼å¼ï¼‰

# 3. æ£€æŸ¥è¯·æ±‚é…é¢
# ç™»å½• TMDB è´¦å·æŸ¥çœ‹ API ä½¿ç”¨æƒ…å†µ
```

### é—®é¢˜4ï¼šæ•°æ®åº“é”å®šé”™è¯¯

**åŸå› **ï¼šSQLite ä¸æ”¯æŒé«˜å¹¶å‘å†™å…¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ£€æŸ¥æ˜¯å¦æœ‰é•¿æ—¶é—´è¿è¡Œçš„äº‹åŠ¡
docker compose logs tv-tracker-api | grep -i "database"

# 2. é‡å¯æœåŠ¡é‡Šæ”¾é”
docker compose restart tv-tracker-api

# 3. æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æƒé™
ls -la data/tv_tracker.db
chmod 664 data/tv_tracker.db
```

### é—®é¢˜5ï¼šç«¯å£å·²è¢«å ç”¨

**åŸå› **ï¼š80 ç«¯å£è¢«å…¶ä»–æœåŠ¡å ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :80
netstat -tulpn | grep :80

# 2. ä¿®æ”¹ docker-compose.yml ç«¯å£æ˜ å°„
# å°† "80:80" æ”¹ä¸º "8080:80"

# 3. é‡å¯æœåŠ¡
docker compose up -d
```

### é—®é¢˜6ï¼šæ¯æ—¥æŠ¥å‘Šæœªå‘é€

**åŸå› **ï¼šæ—¶é—´é…ç½®é”™è¯¯æˆ– Bot æƒé™é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ£€æŸ¥ REPORT_TIME æ ¼å¼ï¼ˆåº”ä¸º HH:MMï¼‰
grep REPORT_TIME .env

# 2. æ£€æŸ¥æ—¶åŒºè®¾ç½®
docker compose exec tv-tracker-api date

# 3. éªŒè¯ Bot å¯¹é¢‘é“çš„å‘é€æƒé™
# ç¡®ä¿ Bot å·²è¢«æ·»åŠ åˆ°é¢‘é“å¹¶å…·æœ‰å‘é€æ¶ˆæ¯æƒé™

# 4. æ‰‹åŠ¨è§¦å‘æµ‹è¯•
docker compose exec tv-tracker-api ./tv-tracker -report
```

---

## ğŸ“Š API æ¥å£æ–‡æ¡£

### è®¤è¯æ–¹å¼

æ‰€æœ‰ API è¯·æ±‚ï¼ˆé™¤ `/health` å¤–ï¼‰éƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« Bearer Tokenï¼š

```bash
Authorization: Bearer ä½ çš„WEB_API_TOKEN
```

### æ¥å£åˆ—è¡¨

#### 1. å¥åº·æ£€æŸ¥
```http
GET /api/health
```
æ— éœ€è®¤è¯ï¼Œè¿”å›æœåŠ¡çŠ¶æ€ã€‚

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "status": "ok"
}
```

#### 2. è·å–ä»»åŠ¡çœ‹æ¿
```http
GET /api/dashboard
Authorization: Bearer YOUR_TOKEN
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "update_tasks": [
    {
      "id": 1,
      "tv_show_id": 1,
      "tv_show_name": "é¾™ä¹‹å®¶æ—",
      "resource_time": "å‘¨å››å‡Œæ™¨3ç‚¹",
      "task_type": "UPDATE",
      "description": "ç¬¬äºŒå­£ ç¬¬5é›†",
      "is_completed": false,
      "created_at": "2024-01-09T08:00:00Z"
    }
  ],
  "organize_tasks": []
}
```

#### 3. è·å–ä»Šæ—¥æ›´æ–°
```http
GET /api/today
Authorization: Bearer YOUR_TOKEN
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "episodes": [
    {
      "episode": {
        "id": 123,
        "tmdb_id": 456,
        "season": 2,
        "episode": 5,
        "title": "Regent",
        "overview": "å‰§é›†ç®€ä»‹...",
        "air_date": "2024-01-09"
      },
      "show_name": "é¾™ä¹‹å®¶æ—",
      "resource_time": "å‘¨å››å‡Œæ™¨3ç‚¹",
      "show_id": 1
    }
  ]
}
```

#### 4. æœç´¢å‰§é›†
```http
GET /api/search?q=house
Authorization: Bearer YOUR_TOKEN
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "results": [
    {
      "id": 123,
      "name": "House of the Dragon",
      "poster_path": "/path.jpg",
      "first_air_date": "2022-08-21",
      "origin_country": ["US"]
    }
  ]
}
```

#### 5. è®¢é˜…å‰§é›†
```http
POST /api/subscribe
Authorization: Bearer YOUR_TOKEN
Content-Type: application/json

{
  "tmdb_id": 12345
}
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "show": {
    "id": 1,
    "tmdb_id": 12345,
    "name": "é¾™ä¹‹å®¶æ—",
    "total_seasons": 2,
    "status": "Returning Series",
    "origin_country": "US",
    "resource_time": "",
    "is_archived": false,
    "created_at": "2024-01-09T08:00:00Z",
    "updated_at": "2024-01-09T08:00:00Z"
  }
}
```

#### 6. å–æ¶ˆè®¢é˜…
```http
DELETE /api/subscribe/:id
Authorization: Bearer YOUR_TOKEN
```

#### 7. è·å–ç‰‡åº“åˆ—è¡¨
```http
GET /api/library
Authorization: Bearer YOUR_TOKEN
```

#### 8. å®Œæˆä»»åŠ¡
```http
POST /api/tasks/:id/complete
Authorization: Bearer YOUR_TOKEN
```

#### 9. å»¶æœŸä»»åŠ¡
```http
POST /api/tasks/:id/postpone
Authorization: Bearer YOUR_TOKEN
```

#### 10. æ›´æ–°èµ„æºæ—¶é—´
```http
PUT /api/shows/:id/resource-time
Authorization: Bearer YOUR_TOKEN
Content-Type: application/json

{
  "resource_time": "å‘¨å››å‡Œæ™¨3ç‚¹"
}
```

#### 11. æ‰‹åŠ¨å¤‡ä»½
```http
POST /api/backup
Authorization: Bearer YOUR_TOKEN
```

---

## ğŸ¯ ä½¿ç”¨æŠ€å·§

### 1. é«˜æ•ˆç®¡ç†è®¢é˜…

**æ‰¹é‡è®¢é˜…åŒä¸€ç³»åˆ—**
- ä½¿ç”¨æœç´¢åŠŸèƒ½æ‰¾åˆ°å‰§é›†
- ä¸€æ¬¡è®¢é˜…å³å¯è‡ªåŠ¨åŒæ­¥æ‰€æœ‰å­£é›†
- ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºè§‚çœ‹ä»»åŠ¡

**è®¾ç½®åˆç†çš„èµ„æºæ—¶é—´**
- æ ¹æ®å®é™…æƒ…å†µè®¾ç½®ï¼ˆå¦‚"å‘¨å››å‡Œæ™¨3ç‚¹"ï¼‰
- è¿™ä¼šä½œä¸ºæ¯æ—¥æŠ¥å‘Šçš„å‚è€ƒ
- å¸®åŠ©æ‚¨åˆç†å®‰æ’ä¸‹è½½/è§‚çœ‹æ—¶é—´

### 2. ä»»åŠ¡ç®¡ç†æœ€ä½³å®è·µ

**æ¯æ—¥æ£€æŸ¥æµç¨‹**
1. æ—©ä¸ŠæŸ¥çœ‹ Telegram æ—¥æŠ¥
2. ç™»å½• Web ç•Œé¢æŸ¥çœ‹ä»»åŠ¡çœ‹æ¿
3. å®Œæˆå·²è§‚çœ‹çš„é›†æ•°
4. å»¶æœŸæ— æ³•å®Œæˆçš„ä»»åŠ¡

**å®šæœŸæ•´ç†**
- æ¯å‘¨æ£€æŸ¥"æ•´ç†ä»»åŠ¡"
- å®Œç»“çš„å‰§é›†åŠæ—¶å½’æ¡£
- ä¿æŒè®¢é˜…åˆ—è¡¨æ•´æ´

### 3. æ•°æ®å®‰å…¨å»ºè®®

**å®šæœŸå¤‡ä»½**
- ä¾èµ–è‡ªåŠ¨å¤‡ä»½ï¼ˆæ¯å‘¨ä¸€æ¬¡ï¼‰
- é‡è¦æ“ä½œå‰æ‰‹åŠ¨å¤‡ä»½
- å¤‡ä»½æ–‡ä»¶å¼‚åœ°ä¿å­˜

**ç›‘æ§æ—¥å¿—**
```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker compose logs -f

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
docker compose logs | grep -i error
```

---

## ğŸ“ˆ ç³»ç»Ÿç›‘æ§

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker compose ps

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f tv-tracker-api
docker compose logs -f tv-tracker-web
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ•°æ®åº“ä¼˜åŒ–**
   - å®šæœŸæ¸…ç†å·²å½’æ¡£çš„æ—§æ•°æ®
   - ä¿æŒæ•°æ®åº“æ–‡ä»¶å¤§å°åˆç†

2. **ç½‘ç»œä¼˜åŒ–**
   - ä½¿ç”¨ CDN åŠ é€Ÿå‰ç«¯èµ„æº
   - é…ç½® Nginx ç¼“å­˜ç­–ç•¥

3. **å­˜å‚¨ä¼˜åŒ–**
   - å®šæœŸæ¸…ç†æ—§å¤‡ä»½æ–‡ä»¶ï¼ˆä¿ç•™æœ€è¿‘ 7-30 å¤©ï¼‰
   - ç›‘æ§ç£ç›˜ä½¿ç”¨æƒ…å†µ

---

## ğŸ” å®‰å…¨å»ºè®®

### 1. å¯†ç å®‰å…¨

- ä½¿ç”¨å¼ºå¯†ç ä½œä¸º `WEB_API_TOKEN`
- å®šæœŸæ›´æ¢å¯†ç 
- ä¸è¦åœ¨å…¬ç½‘æ³„éœ²é…ç½®æ–‡ä»¶

### 2. ç½‘ç»œå®‰å…¨

- å»ºè®®é…ç½®åå‘ä»£ç†ï¼ˆNginxï¼‰
- å¯ç”¨ HTTPSï¼ˆä½¿ç”¨ Let's Encryptï¼‰
- é™åˆ¶ API è®¿é—® IP ç™½åå•

### 3. æ•°æ®å®‰å…¨

- å®šæœŸå¤‡ä»½æ•°æ®åº“
- å¤‡ä»½æ–‡ä»¶åŠ å¯†å­˜å‚¨
- è®¾ç½®åˆç†çš„æ–‡ä»¶æƒé™

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è·å–å¸®åŠ©

- **GitHub Issues**ï¼šæäº¤é—®é¢˜å’Œå»ºè®®
- **æ–‡æ¡£**ï¼šæŸ¥çœ‹ `ARCHITECTURE.md` äº†è§£æ¶æ„
- **æ—¥å¿—**ï¼šæä¾›è¯¦ç»†æ—¥å¿—ä¾¿äºæ’æŸ¥é—®é¢˜

### å¸¸ç”¨å‘½ä»¤

```bash
# é‡å¯æœåŠ¡
docker compose restart

# æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
git pull
docker compose build
docker compose up -d

# æŸ¥çœ‹ç‰ˆæœ¬
docker compose exec tv-tracker-api ./tv-tracker -version

# æ¸…ç†æ—§æ•°æ®
docker compose exec tv-tracker-api ./tv-tracker -cleanup
```

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-01-09)
- âœ… åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… æ”¯æŒ TMDB é›†æˆ
- âœ… Telegram Bot åŠŸèƒ½
- âœ… Web ç®¡ç†ç•Œé¢
- âœ… è‡ªåŠ¨å¤‡ä»½åŠŸèƒ½
- âœ… æ¯æ—¥æŠ¥å‘Šæ¨é€

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰**